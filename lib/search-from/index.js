import{__assign as e,__rest as n}from"../node_modules/tslib/tslib.es6.js";import t,{forwardRef as a,useState as r,useRef as s,useEffect as i}from"react";import{Form as o,Space as c,Button as l}from"antd";import{inlineformlabelCol as m,formnolabelCol as d,horizontalformlabelCol as h}from"./index.inter.js";import{DownOutlined as u,UpOutlined as p}from"@ant-design/icons";import{isEmpty as f,isFunction as v}from"../utils/index.js";import{cloneDeep as w}from"lodash-es";import E from"classnames";import g from"moment";var N=function(a){var r=a.label,s=a.labelminwidth,i=void 0===s?60:s,c=a.children,l=n(a,["label","labelminwidth","children"]),m=r;return m&&"string"==typeof m&&(m=t.createElement("span",{style:{minWidth:i}},r)),t.createElement(o.Item,e({label:m},l),c)},y=null,b=function(a){var N=a.collapsed,b=void 0!==N&&N,j=a.nolabel,_=void 0!==j&&j,S=a.collapsedlen,x=void 0===S?4:S,F=a.hiddenReset,I=void 0!==F&&F,T=a.children,k=a.layout,C=a.searchText,D=void 0===C?"查询":C,O=a.resetText,R=void 0===O?"重置":O,z=a.savesearchparam,V=a.fielddatafromat,J=a.forwardRef,W=a.containerDom;a.onFinish;var L=a.onValuesChange,P=a.onFinishData,q=n(a,["collapsed","nolabel","collapsedlen","hiddenReset","children","layout","searchText","resetText","savesearchparam","fielddatafromat","forwardRef","containerDom","onFinish","onValuesChange","onFinishData"]),A=o.useForm()[0],B=r(b),G=B[0],H=B[1],K=r(x),M=K[0],Q=K[1],U=s();i((function(){X(),window.addEventListener("resize",X);var e=window.sessionStorage.getItem("search_params_session_".concat(z));return f(e)&&window.sessionStorage.setItem("search-from-values",JSON.stringify(q.initialValues||{})),function(){y&&(clearTimeout(y),y=null);var e=window.sessionStorage.getItem("search_params_session_".concat(z));f(e)&&window.sessionStorage.removeItem("search-from-values"),window.removeEventListener("resize",X)}}),[]),i((function(){U.current?W&&X(!0):U.current=!0}),[W]);var X=function(e){if(y&&!e)return!1;var n=document.documentElement.clientWidth-200;W&&(n=W.clientWidth);var t=x||4;n<900?t-=3:n>=900&&n<1200?t-=2:n>=1200&&n<1450&&(t-=1),t!==M&&Q(t),y=setTimeout((function(){clearTimeout(y),y=null}),300)},Y=function(e,n){if(V){var t=null==V?void 0:V.find((function(n){return n.name===e}));return"time"===(null==t?void 0:t.type)?v(n)?[g(n[0]),g(n[1])]:g(n):"number"===(null==t?void 0:t.type)?Number(n):n}return n},Z=function(e,n){z&&("reset"===e?window.sessionStorage.removeItem("search_params_session_".concat(z)):window.sessionStorage.setItem("search_params_session_".concat(z),JSON.stringify(n))),P&&P(n,e),L&&L({},n)},$=function(){H(!G)},ee=function(e){var n=[],t=[],a=!1,r=1;return e.forEach((function(e){r>M?e.props&&e.props.hidden?t.push({child:e,hidden:!0}):(t.push({child:e,hidden:!1}),a=!0,r++):e.props&&e.props.hidden?n.push({child:e,hidden:!0}):(n.push({child:e,hidden:!1}),r++)})),[n,t,a]}(v(T)?T:[T]),ne=ee[0],te=ee[1],ae=ee[2],re=m;return _?re=d:"horizontal"===k&&(re=h),t.createElement(o,e({ref:J,form:A,layout:k||"inline",onFinish:function(e){return Z("submit",e)},className:"search-container"},re,q),t.createElement("div",{className:"sj-search-content"},t.createElement("div",{className:"sj-search-left-content"},t.createElement("div",{className:"sj-search-row"},ne.map((function(e,n){return t.createElement("div",{className:E("sj-search-col-".concat(M),{"sj-search-col-hidden":e.hidden}),key:n},e.child)}))),t.createElement("div",{className:E("sj-search-row",{"search-container-collapsed-col-show":G,"search-container-collapsed-col-hidden":!G})},te.map((function(e,n){return t.createElement("div",{className:E("sj-search-col-".concat(M),{"sj-search-col-hidden":e.hidden}),key:n},e.child)})))),t.createElement("div",{className:"sj-search-right-content"},t.createElement(c,{size:10,style:{float:"right"},className:"search-container-collapsed-content"},!I&&t.createElement(l,{onClick:function(){var e=window.sessionStorage.getItem("search-from-values")||"{}";if(f(e))A.resetFields();else{var n=JSON.parse(e),t=[],a=A.getFieldsValue();for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(V?(n[r]=Y(r,n[r]),t.push({name:r,value:Y(r,n[r])})):isNaN(n[r])&&!isNaN(Date.parse(n[r]))?(n[r]=g(n[r]),t.push({name:r,value:g(n[r])})):t.push({name:r,value:n[r]}));Z("reset",w(n)),A.setFields(t)}}},R),t.createElement(l,{type:"primary",htmlType:"submit"},D),ae&&!G&&t.createElement("span",{className:"search-container-collapsed-text",onClick:$},"展开",t.createElement(u,null)),ae&&G&&t.createElement("span",{className:"search-container-collapsed-text",onClick:$},"收起",t.createElement(p,null))))))},j=a((function(n,a){return t.createElement(b,e({},n,{forwardRef:a}))}));j.Item=N;export{N as Item,j as default};
//# sourceMappingURL=index.js.map
